<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #545454; font-weight: bold; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #a1024a; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007faa; font-weight: bold; } /* ControlFlow */
code span.ch { color: #008000; } /* Char */
code span.cn { color: #d91e18; } /* Constant */
code span.co { color: #545454; } /* Comment */
code span.cv { color: #545454; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #aa5d00; } /* DataType */
code span.dv { color: #a1024a; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #a1024a; } /* Float */
code span.fu { color: #4254a7; } /* Function */
code span.im { } /* Import */
code span.in { color: #545454; font-weight: bold; } /* Information */
code span.kw { color: #007faa; font-weight: bold; } /* Keyword */
code span.op { color: #696969; } /* Operator */
code span.ot { color: #007faa; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #008000; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #008000; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #008000; } /* VerbatimString */
code span.wa { color: #545454; font-weight: bold; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Converting nested JSON to a tidy data frame with R</title>

  <meta property="description" itemprop="description" content="Converting nested JSON to a tidy data frame with R"/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2018-10-20"/>
  <meta property="article:created" itemprop="dateCreated" content="2018-10-20"/>
  <meta name="article:author" content="Tony ElHabr"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Converting nested JSON to a tidy data frame with R"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Converting nested JSON to a tidy data frame with R"/>
  <meta property="og:image" content="https//tonyelhabr.rbind.io/featured.jpg"/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary_large_image"/>
  <meta property="twitter:title" content="Converting nested JSON to a tidy data frame with R"/>
  <meta property="twitter:description" content="Converting nested JSON to a tidy data frame with R"/>
  <meta property="twitter:image" content="https//tonyelhabr.rbind.io/featured.jpg"/>
  <meta property="twitter:site" content="@TonyElHabr"/>
  <meta property="twitter:creator" content="@TonyElHabr"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","base_url","date","categories","output","preview","twitter"]}},"value":[{"type":"character","attributes":{},"value":["Converting nested JSON to a tidy data frame with R"]},{"type":"character","attributes":{},"value":["Converting nested JSON to a tidy data frame with R"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Tony ElHabr"]},{"type":"character","attributes":{},"value":["https://twitter.com/TonyElHabr"]}]}]},{"type":"character","attributes":{},"value":["https//tonyelhabr.rbind.io"]},{"type":"character","attributes":{},"value":["2018-10-20"]},{"type":"character","attributes":{},"value":["r","json","dplyr","tidyr","nfl"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","toc_depth","self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[3]},{"type":"logical","attributes":{},"value":[false]}]}]},{"type":"character","attributes":{},"value":["featured.jpg"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["site","creator"]}},"value":[{"type":"character","attributes":{},"value":["@TonyElHabr"]},{"type":"character","attributes":{},"value":["@TonyElHabr"]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["featured.jpg","nested-json-to-tidy-data-frame-r_files/anchor-4.2.2/anchor.min.js","nested-json-to-tidy-data-frame-r_files/bowser-1.9.3/bowser.min.js","nested-json-to-tidy-data-frame-r_files/distill-2.2.21/template.v2.js","nested-json-to-tidy-data-frame-r_files/header-attrs-2.6/header-attrs.js","nested-json-to-tidy-data-frame-r_files/jquery-1.11.3/jquery.min.js","nested-json-to-tidy-data-frame-r_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: hidden;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="nested-json-to-tidy-data-frame-r_files/header-attrs-2.6/header-attrs.js"></script>
  <script src="nested-json-to-tidy-data-frame-r_files/jquery-1.11.3/jquery.min.js"></script>
  <script src="nested-json-to-tidy-data-frame-r_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="nested-json-to-tidy-data-frame-r_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="nested-json-to-tidy-data-frame-r_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="nested-json-to-tidy-data-frame-r_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Converting nested JSON to a tidy data frame with R","description":"Converting nested JSON to a tidy data frame with R","authors":[{"author":"Tony ElHabr","authorURL":"https://twitter.com/TonyElHabr","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2018-10-20T00:00:00.000-05:00","citationText":"ElHabr, 2018"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Converting nested JSON to a tidy data frame with R</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
<div class="dt=tag">r</div>
<div class="dt=tag">json</div>
<div class="dt=tag">dplyr</div>
<div class="dt=tag">tidyr</div>
<div class="dt=tag">nfl</div>
</div>
<!--/radix_placeholder_categories-->
<p>Converting nested JSON to a tidy data frame with R</p>
</div>

<div class="d-byline">
  Tony ElHabr <a href="https://twitter.com/TonyElHabr" class="uri">https://twitter.com/TonyElHabr</a> 
  
<br/>2018-10-20
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#getting-the-data">Getting the data</a></li>
<li><a href="#parsing-the-data">Parsing the data</a></li>
<li><a href="#post-processing-the-data">Post-processing the data</a></li>
<li><a href="#sign-off">Sign-off</a></li>
</ul>
</nav>
</div>
<p><strong><em>UPDATE: The data retrieval demonstrated in this post no longer seems to work due to a change in the ESPN’S “secret” API. In any matter, the techniques for working with JSON data are still valid.</em></strong></p>
<p>In this “how-to” post, I want to detail an approach that others may find useful for converting nested (nasty!) json to a <a href="http://r4ds.had.co.nz/tidy-data.html">tidy</a> (nice!) <code>data.frame</code>/<code>tibble</code> that is should be much easier to work with. <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>For this demonstration, I’ll start out by scraping <a href="https://www.nfl.com/">National Football League</a> (NFL) 2018 regular season week 1 score data from <a href="http://www.espn.com/">ESPN</a>, which involves lots of nested data in its raw form. <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p>Then, I’ll work towards getting the data in a workable format (a <code>data.frame</code>!). (This is the crux of what I want to show.) Finally, I’ll filter and wrangle the data to generate a final, presentable format.</p>
<p>Even if one does not care for sports and knows nothing about the NFL, I believe that the techniques that I demonstrate are generalizable to a broad set of JSON-related “problems”.</p>
<h2 id="getting-the-data">Getting the data</h2>
<p>Let’s being with importing the package(s) that we’ll need.</p>
<p>Next, we’ll create a variable for the url from which we will get the data. The url here will request the scores for week 1 of the 2018 NFL season from <a href="https://gist.github.com/akeaswaran/b48b02f1c94f873c6655e7129910fc3b">ESPN’s “secret” API</a>. <a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>url</span> <span class='op'>&lt;-</span> <span class='st'>"http://site.api.espn.com/apis/site/v2/sports/football/nfl/scoreboard?&amp;dates=2018&amp;seasontype=2&amp;week=1"</span>
</code></pre>
</div>
</div>
<p>And now, the actual HTTP <code>GET</code> request for the data (using the <a href="https://cran.r-project.org/web/packages/httr/index.html"><code>{httr}</code></a> package’s appropriately named <code>GET()</code> function).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>resp</span> <span class='op'>&lt;-</span> <span class='fu'>httr</span><span class='fu'>::</span><span class='fu'><a href='https://httr.r-lib.org/reference/GET.html'>GET</a></span><span class='op'>(</span><span class='va'>url</span><span class='op'>)</span>
<span class='va'>resp</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'>## Response [http://site.api.espn.com/apis/site/v2/sports/football/nfl/scoreboard?&amp;dates=2018&amp;seasontype=2&amp;week=1]</span>
<span class='co'>##   Date: 2018-10-24 18:41</span>
<span class='co'>##   Status: 200</span>
<span class='co'>##   Content-Type: application/json;charset=UTF-8</span>
<span class='co'>##   Size: 189 kB</span>
</code></pre>
</div>
</div>
<p>Everything seems to be going well. However, after using another handy <code>{httr}</code> function—<code>content()</code>—to extract the data, we see that the data is an nasty nested format! (I only print out some of the top-level elements to avoid cluttering the page.)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>cont_raw</span> <span class='op'>&lt;-</span> <span class='fu'>httr</span><span class='fu'>::</span><span class='fu'><a href='https://httr.r-lib.org/reference/content.html'>content</a></span><span class='op'>(</span><span class='va'>resp</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='va'>cont_raw</span>, max.level <span class='op'>=</span> <span class='fl'>3</span>, list.len <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'>## List of 4</span>
<span class='co'>##  $ leagues:List of 1</span>
<span class='co'>##   ..$ :List of 11</span>
<span class='co'>##   .. ..$ id                 : chr "28"</span>
<span class='co'>##   .. ..$ uid                : chr "s:20~l:28"</span>
<span class='co'>##   .. ..$ name               : chr "National Football League"</span>
<span class='co'>##   .. ..$ abbreviation       : chr "NFL"</span>
<span class='co'>##   .. .. [list output truncated]</span>
<span class='co'>##  $ season :List of 2</span>
<span class='co'>##   ..$ type: int 2</span>
<span class='co'>##   ..$ year: int 2018</span>
<span class='co'>##  $ week   :List of 1</span>
<span class='co'>##   ..$ number: int 1</span>
<span class='co'>##  $ events :List of 16</span>
<span class='co'>##   ..$ :List of 9</span>
<span class='co'>##   .. ..$ id          : chr "401030710"</span>
<span class='co'>##   .. ..$ uid         : chr "s:20~l:28~e:401030710"</span>
<span class='co'>##   .. ..$ date        : chr "2018-09-07T00:55Z"</span>
<span class='co'>##   .. ..$ name        : chr "Atlanta Falcons at Philadelphia Eagles"</span>
<span class='co'>##   .. .. [list output truncated]</span>
<span class='co'>##   ..$ :List of 9</span>
<span class='co'>##   .. ..$ id          : chr "401030718"</span>
<span class='co'>##   .. ..$ uid         : chr "s:20~l:28~e:401030718"</span>
<span class='co'>##   .. ..$ date        : chr "2018-09-09T17:00Z"</span>
<span class='co'>##   .. ..$ name        : chr "Pittsburgh Steelers at Cleveland Browns"</span>
<span class='co'>##   .. .. [list output truncated]</span>
<span class='co'>##   ..$ :List of 9</span>
<span class='co'>##   .. ..$ id          : chr "401030717"</span>
<span class='co'>##   .. ..$ uid         : chr "s:20~l:28~e:401030717"</span>
<span class='co'>##   .. ..$ date        : chr "2018-09-09T17:00Z"</span>
<span class='co'>##   .. ..$ name        : chr "Cincinnati Bengals at Indianapolis Colts"</span>
<span class='co'>##   .. .. [list output truncated]</span>
<span class='co'>##   ..$ :List of 9</span>
<span class='co'>##   .. ..$ id          : chr "401030716"</span>
<span class='co'>##   .. ..$ uid         : chr "s:20~l:28~e:401030716"</span>
<span class='co'>##   .. ..$ date        : chr "2018-09-09T17:00Z"</span>
<span class='co'>##   .. ..$ name        : chr "Tennessee Titans at Miami Dolphins"</span>
<span class='co'>##   .. .. [list output truncated]</span>
<span class='co'>##   .. [list output truncated]</span>
</code></pre>
</div>
</div>
<h2 id="parsing-the-data">Parsing the data</h2>
<p>Given the nature of the data, we might hope that the <a href="https://cran.r-project.org/web/packages/jsonlite/index.html"><code>{jsonlite}</code></a> package will save us here. However, straightforward usage of it’s <code>fromJSON()</code> package only reduces the mess a bit.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>df_raw_ugly</span> <span class='op'>&lt;-</span> <span class='fu'>jsonlite</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/jsonlite/man/fromJSON.html'>fromJSON</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rawConversion.html'>rawToChar</a></span><span class='op'>(</span><span class='va'>resp</span><span class='op'>$</span><span class='va'>content</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>glimpse</span><span class='op'>(</span><span class='va'>df_raw_ugly</span>, max.level <span class='op'>=</span> <span class='fl'>3</span>, list.len <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'>## List of 4</span>
<span class='co'>##  $ leagues:'data.frame': 1 obs. of  11 variables:</span>
<span class='co'>##   ..$ id                 : chr "28"</span>
<span class='co'>##   ..$ uid                : chr "s:20~l:28"</span>
<span class='co'>##   ..$ name               : chr "National Football League"</span>
<span class='co'>##   ..$ abbreviation       : chr "NFL"</span>
<span class='co'>##   .. [list output truncated]</span>
<span class='co'>##  $ season :List of 2</span>
<span class='co'>##   ..$ type: int 2</span>
<span class='co'>##   ..$ year: int 2018</span>
<span class='co'>##  $ week   :List of 1</span>
<span class='co'>##   ..$ number: int 1</span>
<span class='co'>##  $ events :'data.frame': 16 obs. of  9 variables:</span>
<span class='co'>##   ..$ id          : chr [1:16] "401030710" "401030718" "401030717" "401030716" ...</span>
<span class='co'>##   ..$ uid         : chr [1:16] "s:20~l:28~e:401030710" "s:20~l:28~e:401030718" "s:20~l:28~e:401030717" "s:20~l:28~e:401030716" ...</span>
<span class='co'>##   ..$ date        : chr [1:16] "2018-09-07T00:55Z" "2018-09-09T17:00Z" "2018-09-09T17:00Z" "2018-09-09T17:00Z" ...</span>
<span class='co'>##   ..$ name        : chr [1:16] "Atlanta Falcons at Philadelphia Eagles" "Pittsburgh Steelers at Cleveland Browns" "Cincinnati Bengals at Indianapolis Colts" "Tennessee Titans at Miami Dolphins" ...</span>
<span class='co'>##   .. [list output truncated]</span>
</code></pre>
</div>
</div>
<p>One could go on and try some other functions from the <code>{jsonlite}</code> package (or another JSON-related package), but, in my own attempts, I was unable to figure out a nice way of getting a <code>data.frame()</code>. (This is not to say that there is something wrong with the package—I simply could not figure out how to use it to get the result that I wanted.)</p>
<p>So, what to do now? Well, after some struggling, I stumbled upon the following solution to put me on the right path.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>df_raw</span> <span class='op'>&lt;-</span> <span class='fu'>enframe</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='va'>cont_raw</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>df_raw</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'>## # A tibble: 6,629 x 2</span>
<span class='co'>##    name                     value                   </span>
<span class='co'>##    &lt;chr&gt;                    &lt;chr&gt;                   </span>
<span class='co'>##  1 leagues.id               28                      </span>
<span class='co'>##  2 leagues.uid              s:20~l:28               </span>
<span class='co'>##  3 leagues.name             National Football League</span>
<span class='co'>##  4 leagues.abbreviation     NFL                     </span>
<span class='co'>##  5 leagues.slug             nfl                     </span>
<span class='co'>##  6 leagues.season.year      2018                    </span>
<span class='co'>##  7 leagues.season.startDate 2018-08-02T07:00Z       </span>
<span class='co'>##  8 leagues.season.endDate   2019-02-06T07:59Z       </span>
<span class='co'>##  9 leagues.season.type.id   2                       </span>
<span class='co'>## 10 leagues.season.type.type 2                       </span>
<span class='co'>## # ... with 6,619 more rows</span>
</code></pre>
</div>
</div>
<p>Combining <code>unlist()</code> and <code>tibble::enframe()</code>, we are able to get a (very) long data.frame without any nested elements! Note that the would-have-been-nested elements are joined by “.” in the “name” column, and the values associated with these elements are in the “value” column. (These are the default column names that <code>tibble::enframe()</code> assigns to the <code>tibble</code> that it creates from a list.)</p>
<p>While this <code>tibble</code> is still not in a tidy format—there are variables implicitly stored in the “name” column rather than in their own columns—–it’s in a much more user-friendly format (in my opinion). (e.g The variable <code>"leagues.season.startDate"</code> implicitly encodes three variables—<code>"leagues"</code>, <code>"season"</code>, and <code>"startDate"</code>—each deserving of their own column.)</p>
<p>Given the format of the implicit variable sin the “name” column, We can use <code>tidyr::separate()</code> to create columns for each.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>df_raw</span> <span class='op'>%&gt;%</span> <span class='fu'>separate</span><span class='op'>(</span><span class='va'>name</span>, into <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'>## Warning: Expected 10 pieces. Missing pieces filled with `NA` in 6629</span>
<span class='co'>## rows [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19,</span>
<span class='co'>## 20, ...].</span>

<span class='co'>## # A tibble: 6,629 x 11</span>
<span class='co'>##    x1     x2      x3    x4    x5    x6    x7    x8    x9    x10   value   </span>
<span class='co'>##    &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   </span>
<span class='co'>##  1 leagu~ id      &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  28      </span>
<span class='co'>##  2 leagu~ uid     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  s:20~l:~</span>
<span class='co'>##  3 leagu~ name    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  Nationa~</span>
<span class='co'>##  4 leagu~ abbrev~ &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  NFL     </span>
<span class='co'>##  5 leagu~ slug    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  nfl     </span>
<span class='co'>##  6 leagu~ season  year  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  2018    </span>
<span class='co'>##  7 leagu~ season  star~ &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  2018-08~</span>
<span class='co'>##  8 leagu~ season  endD~ &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  2019-02~</span>
<span class='co'>##  9 leagu~ season  type  id    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  2       </span>
<span class='co'>## 10 leagu~ season  type  type  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  2       </span>
<span class='co'>## # ... with 6,619 more rows</span>
</code></pre>
</div>
</div>
<p>We get a warning indicating when using <code>separate()</code> because we have “over-estimated” how many columns we will need to create. Note that, with my specification of (dummy) column names with the <code>into</code> argument, I guessed that there we would need 10 columns. Why 10? Because I expected that 10 would be more than I needed, and it’s better to over-estimate and remove the extra columns in a subsequent step than to under-estimate and lose data because there are not enough columns to put the “separated” data in.</p>
<p>We can get rid of the warning by providing an appropriate value for <code>separate()</code>’s <code>fill</code> argument. (Note that <code>"warn"</code> is the default value of the <code>fill</code> argument.)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>df_raw</span> <span class='op'>%&gt;%</span> <span class='fu'>separate</span><span class='op'>(</span><span class='va'>name</span>, into <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"x"</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span>, fill <span class='op'>=</span> <span class='st'>"right"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'>## # A tibble: 6,629 x 11</span>
<span class='co'>##    x1     x2      x3    x4    x5    x6    x7    x8    x9    x10   value   </span>
<span class='co'>##    &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   </span>
<span class='co'>##  1 leagu~ id      &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  28      </span>
<span class='co'>##  2 leagu~ uid     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  s:20~l:~</span>
<span class='co'>##  3 leagu~ name    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  Nationa~</span>
<span class='co'>##  4 leagu~ abbrev~ &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  NFL     </span>
<span class='co'>##  5 leagu~ slug    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  nfl     </span>
<span class='co'>##  6 leagu~ season  year  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  2018    </span>
<span class='co'>##  7 leagu~ season  star~ &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  2018-08~</span>
<span class='co'>##  8 leagu~ season  endD~ &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  2019-02~</span>
<span class='co'>##  9 leagu~ season  type  id    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  2       </span>
<span class='co'>## 10 leagu~ season  type  type  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  2       </span>
<span class='co'>## # ... with 6,619 more rows</span>
</code></pre>
</div>
</div>
<p>However, while this action gets rid of the warning, it does not actually resolve the underlying issue—specifying the correct number of columns to create with <code>separate()</code>. We can do that by identifying the <code>name</code> with the most number of “dots” (i.e. <code>.</code>s).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>rgx_split</span> <span class='op'>&lt;-</span> <span class='st'>"\\."</span>
<span class='va'>n_cols_max</span> <span class='op'>&lt;-</span>
  <span class='va'>df_raw</span> <span class='op'>%&gt;%</span>
  <span class='fu'>pull</span><span class='op'>(</span><span class='va'>name</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>str_split</span><span class='op'>(</span><span class='va'>rgx_split</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>map_dbl</span><span class='op'>(</span><span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>.</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>n_cols_max</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'>## [1] 7</span>
</code></pre>
</div>
</div>
<p>With this number (7) identified, we can now choose the “correct” number of columns to create with <code>separate()</code>. Note that we’ll still be left with lots of <code>NA</code> values (corresponding to rows that don’t have the maximum number of variables). This is expected.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>nms_sep</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>"name"</span>, <span class='fl'>1</span><span class='op'>:</span><span class='va'>n_cols_max</span><span class='op'>)</span>
<span class='va'>df_sep</span> <span class='op'>&lt;-</span>
  <span class='va'>df_raw</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>separate</span><span class='op'>(</span><span class='va'>name</span>, into <span class='op'>=</span> <span class='va'>nms_sep</span>, sep <span class='op'>=</span> <span class='va'>rgx_split</span>, fill <span class='op'>=</span> <span class='st'>"right"</span><span class='op'>)</span>
<span class='va'>df_sep</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'>## # A tibble: 6,629 x 8</span>
<span class='co'>##    name1   name2      name3    name4 name5 name6 name7 value              </span>
<span class='co'>##    &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;              </span>
<span class='co'>##  1 leagues id         &lt;NA&gt;     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  28                 </span>
<span class='co'>##  2 leagues uid        &lt;NA&gt;     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  s:20~l:28          </span>
<span class='co'>##  3 leagues name       &lt;NA&gt;     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  National Football ~</span>
<span class='co'>##  4 leagues abbreviat~ &lt;NA&gt;     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  NFL                </span>
<span class='co'>##  5 leagues slug       &lt;NA&gt;     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  nfl                </span>
<span class='co'>##  6 leagues season     year     &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  2018               </span>
<span class='co'>##  7 leagues season     startDa~ &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  2018-08-02T07:00Z  </span>
<span class='co'>##  8 leagues season     endDate  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  2019-02-06T07:59Z  </span>
<span class='co'>##  9 leagues season     type     id    &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  2                  </span>
<span class='co'>## 10 leagues season     type     type  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  2                  </span>
<span class='co'>## # ... with 6,619 more rows</span>
</code></pre>
</div>
</div>
<p>By my interpretation, this <code>df_sep</code> variable is in tidy format. (Of course, there is still lots of cleaning to be done before it can actually be useful!)</p>
<h2 id="post-processing-the-data">Post-processing the data</h2>
<p>Getting the raw data in the format that <code>df_sep</code> is what I primarily wanted to show. Nonetheless, there’s more to the story! (Reminder: We’re seeking to get the scores from the 16 games in week 1 of the NFL’s 2018 regular season.) How can we work with the <code>NA</code>s to get a final format that is actually presentable?</p>
<p>We continue by filter the <code>tibble</code> for only the rows that we will need.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>df_filt</span> <span class='op'>&lt;-</span>
  <span class='va'>df_sep</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span>
    <span class='op'>(</span>
      <span class='va'>name1</span> <span class='op'>==</span> <span class='st'>"events"</span> <span class='op'>&amp;</span>
        <span class='va'>name2</span> <span class='op'>==</span> <span class='st'>"shortName"</span>
    <span class='op'>)</span> <span class='op'>|</span>
      <span class='op'>(</span>
        <span class='va'>name1</span> <span class='op'>==</span> <span class='st'>"events"</span> <span class='op'>&amp;</span>
          <span class='va'>name2</span> <span class='op'>==</span> <span class='st'>"competitions"</span> <span class='op'>&amp;</span>
          <span class='va'>name3</span> <span class='op'>==</span> <span class='st'>"date"</span>
      <span class='op'>)</span> <span class='op'>|</span> <span class='op'>(</span>
        <span class='va'>name1</span> <span class='op'>==</span> <span class='st'>"events"</span> <span class='op'>&amp;</span>
          <span class='va'>name2</span> <span class='op'>==</span> <span class='st'>"competitions"</span> <span class='op'>&amp;</span>
          <span class='va'>name3</span> <span class='op'>==</span> <span class='st'>"status"</span> <span class='op'>&amp;</span>
          <span class='va'>name4</span> <span class='op'>==</span> <span class='st'>"type"</span> <span class='op'>&amp;</span>
          <span class='va'>name5</span> <span class='op'>==</span> <span class='st'>"name"</span>
      <span class='op'>)</span> <span class='op'>|</span>
      <span class='op'>(</span>
        <span class='va'>name1</span> <span class='op'>==</span> <span class='st'>"events"</span> <span class='op'>&amp;</span>
          <span class='va'>name2</span> <span class='op'>==</span> <span class='st'>"competitions"</span> <span class='op'>&amp;</span>
          <span class='va'>name3</span> <span class='op'>==</span> <span class='st'>"competitors"</span> <span class='op'>&amp;</span>
          <span class='va'>name4</span> <span class='op'>==</span> <span class='st'>"score"</span>
      <span class='op'>)</span>
  <span class='op'>)</span>
<span class='va'>df_filt</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'>## # A tibble: 80 x 8</span>
<span class='co'>##    name1  name2        name3      name4 name5 name6 name7 value           </span>
<span class='co'>##    &lt;chr&gt;  &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;           </span>
<span class='co'>##  1 events shortName    &lt;NA&gt;       &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  ATL @ PHI       </span>
<span class='co'>##  2 events competitions date       &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  2018-09-07T00:5~</span>
<span class='co'>##  3 events competitions competito~ score &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  18              </span>
<span class='co'>##  4 events competitions competito~ score &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  12              </span>
<span class='co'>##  5 events competitions status     type  name  &lt;NA&gt;  &lt;NA&gt;  STATUS_FINAL    </span>
<span class='co'>##  6 events shortName    &lt;NA&gt;       &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  PIT @ CLE       </span>
<span class='co'>##  7 events competitions date       &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  2018-09-09T17:0~</span>
<span class='co'>##  8 events competitions competito~ score &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  21              </span>
<span class='co'>##  9 events competitions competito~ score &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  21              </span>
<span class='co'>## 10 events competitions status     type  name  &lt;NA&gt;  &lt;NA&gt;  STATUS_FINAL    </span>
<span class='co'>## # ... with 70 more rows</span>
</code></pre>
</div>
</div>
<p>Next, we’ll create appropriately named columns for the values that we filtered for in the step above. <a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>df_clean1</span> <span class='op'>&lt;-</span>
  <span class='va'>df_filt</span> <span class='op'>%&gt;%</span>
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>name3</span>, <span class='va'>name4</span>, <span class='va'>name5</span>, <span class='va'>value</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>status <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>name5</span> <span class='op'>==</span> <span class='st'>"name"</span>, <span class='va'>value</span>, <span class='cn'>NA_character_</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>isscore <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>name4</span> <span class='op'>==</span> <span class='st'>"score"</span>, <span class='cn'>TRUE</span>, <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>datetime <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span>
    <span class='va'>name3</span> <span class='op'>==</span> <span class='st'>"date"</span>,
    <span class='fu'>str_replace_all</span><span class='op'>(</span><span class='va'>value</span>, <span class='st'>"\\s?T\\s?"</span>, <span class='st'>" "</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>str_replace</span><span class='op'>(</span><span class='st'>"Z$"</span>, <span class='st'>""</span><span class='op'>)</span>,
    <span class='cn'>NA_character_</span>
  <span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>gm <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span>
    <span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>isscore</span><span class='op'>)</span> <span class='op'>&amp;</span>
      <span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>datetime</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>status</span><span class='op'>)</span>,
    <span class='va'>value</span>,
    <span class='cn'>NA_character_</span>
  <span class='op'>)</span><span class='op'>)</span>
<span class='va'>df_clean1</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'>## # A tibble: 80 x 8</span>
<span class='co'>##    name3    name4 name5 value       status    isscore datetime     gm     </span>
<span class='co'>##    &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;     &lt;lgl&gt;   &lt;chr&gt;        &lt;chr&gt;  </span>
<span class='co'>##  1 &lt;NA&gt;     &lt;NA&gt;  &lt;NA&gt;  ATL @ PHI   &lt;NA&gt;      NA      &lt;NA&gt;         ATL @ ~</span>
<span class='co'>##  2 date     &lt;NA&gt;  &lt;NA&gt;  2018-09-07~ &lt;NA&gt;      NA      2018-09-07 ~ &lt;NA&gt;   </span>
<span class='co'>##  3 competi~ score &lt;NA&gt;  18          &lt;NA&gt;      TRUE    &lt;NA&gt;         &lt;NA&gt;   </span>
<span class='co'>##  4 competi~ score &lt;NA&gt;  12          &lt;NA&gt;      TRUE    &lt;NA&gt;         &lt;NA&gt;   </span>
<span class='co'>##  5 status   type  name  STATUS_FIN~ STATUS_F~ FALSE   &lt;NA&gt;         &lt;NA&gt;   </span>
<span class='co'>##  6 &lt;NA&gt;     &lt;NA&gt;  &lt;NA&gt;  PIT @ CLE   &lt;NA&gt;      NA      &lt;NA&gt;         PIT @ ~</span>
<span class='co'>##  7 date     &lt;NA&gt;  &lt;NA&gt;  2018-09-09~ &lt;NA&gt;      NA      2018-09-09 ~ &lt;NA&gt;   </span>
<span class='co'>##  8 competi~ score &lt;NA&gt;  21          &lt;NA&gt;      TRUE    &lt;NA&gt;         &lt;NA&gt;   </span>
<span class='co'>##  9 competi~ score &lt;NA&gt;  21          &lt;NA&gt;      TRUE    &lt;NA&gt;         &lt;NA&gt;   </span>
<span class='co'>## 10 status   type  name  STATUS_FIN~ STATUS_F~ FALSE   &lt;NA&gt;         &lt;NA&gt;   </span>
<span class='co'>## # ... with 70 more rows</span>
</code></pre>
</div>
</div>
<p>With these columns created, we can use <code>tidyr::fill()</code> and <code>dplyr::filter()</code> in a strategic manner to get rid of all the <code>NA</code>s cluttering our <code>tibble</code>. Additionally, we can drop the dummy <code>name</code> columns that we created with the <code>tidyr::separate()</code> call before.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>df_clean2</span> <span class='op'>&lt;-</span>
  <span class='va'>df_clean1</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>fill</span><span class='op'>(</span><span class='va'>status</span>, .direction <span class='op'>=</span> <span class='st'>"up"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>status</span> <span class='op'>==</span> <span class='st'>"STATUS_FINAL"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>fill</span><span class='op'>(</span><span class='va'>gm</span>, .direction <span class='op'>=</span> <span class='st'>"down"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>fill</span><span class='op'>(</span><span class='va'>datetime</span>, .direction <span class='op'>=</span> <span class='st'>"down"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>name3</span> <span class='op'>==</span> <span class='st'>"competitors"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='fu'>matches</span><span class='op'>(</span><span class='st'>"name[0-9]"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>df_clean2</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'>## # A tibble: 32 x 5</span>
<span class='co'>##    value status       isscore datetime         gm       </span>
<span class='co'>##    &lt;chr&gt; &lt;chr&gt;        &lt;lgl&gt;   &lt;chr&gt;            &lt;chr&gt;    </span>
<span class='co'>##  1 18    STATUS_FINAL TRUE    2018-09-07 00:55 ATL @ PHI</span>
<span class='co'>##  2 12    STATUS_FINAL TRUE    2018-09-07 00:55 ATL @ PHI</span>
<span class='co'>##  3 21    STATUS_FINAL TRUE    2018-09-09 17:00 PIT @ CLE</span>
<span class='co'>##  4 21    STATUS_FINAL TRUE    2018-09-09 17:00 PIT @ CLE</span>
<span class='co'>##  5 23    STATUS_FINAL TRUE    2018-09-09 17:00 CIN @ IND</span>
<span class='co'>##  6 34    STATUS_FINAL TRUE    2018-09-09 17:00 CIN @ IND</span>
<span class='co'>##  7 27    STATUS_FINAL TRUE    2018-09-09 17:00 TEN @ MIA</span>
<span class='co'>##  8 20    STATUS_FINAL TRUE    2018-09-09 17:00 TEN @ MIA</span>
<span class='co'>##  9 24    STATUS_FINAL TRUE    2018-09-09 17:00 SF @ MIN </span>
<span class='co'>## 10 16    STATUS_FINAL TRUE    2018-09-09 17:00 SF @ MIN </span>
<span class='co'>## # ... with 22 more rows</span>
</code></pre>
</div>
</div>
<p>Finally, we can use a chain of <a href="https://cran.r-project.org/web/packages/dplyr/index.html"><code>{dplyr}</code></a> actions to get a pretty output. I should note that it is likely that everything up to this point would have an analogous action no matter what the data set is that you are working with. However, these final actions are unique to this specific data.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>df_clean3</span> <span class='op'>&lt;-</span>
  <span class='va'>df_clean2</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>gm</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>rn <span class='op'>=</span> <span class='fu'>row_number</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>tm_dir <span class='op'>=</span> <span class='fu'>if_else</span><span class='op'>(</span><span class='va'>rn</span> <span class='op'>==</span> <span class='fl'>1</span>, <span class='st'>"pts_home"</span>, <span class='st'>"pts_away"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>datetime</span>, <span class='va'>gm</span>, <span class='va'>tm_dir</span>, <span class='va'>value</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>spread</span><span class='op'>(</span><span class='va'>tm_dir</span>, <span class='va'>value</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>separate</span><span class='op'>(</span><span class='va'>gm</span>, into <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"tm_away"</span>, <span class='st'>"tm_home"</span><span class='op'>)</span>, sep <span class='op'>=</span> <span class='st'>"(\\s+\\@\\s+)|(\\s+vs.*\\s+)"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate_at</span><span class='op'>(</span><span class='fu'>vars</span><span class='op'>(</span><span class='fu'>matches</span><span class='op'>(</span><span class='st'>"pts"</span><span class='op'>)</span><span class='op'>)</span>, <span class='fu'>funs</span><span class='op'>(</span><span class='va'>as.integer</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>date <span class='op'>=</span> <span class='va'>datetime</span> <span class='op'>%&gt;%</span> <span class='fu'>str_remove</span><span class='op'>(</span><span class='st'>"\\s.*$"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>lubridate</span><span class='fu'>::</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd.html'>ymd</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>time <span class='op'>=</span> <span class='va'>datetime</span> <span class='op'>%&gt;%</span> <span class='fu'>lubridate</span><span class='fu'>::</span><span class='fu'><a href='http://lubridate.tidyverse.org/reference/ymd_hms.html'>ymd_hm</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>date</span>, <span class='va'>time</span>, <span class='va'>tm_home</span>, <span class='va'>tm_away</span>, <span class='va'>pts_home</span>, <span class='va'>pts_away</span><span class='op'>)</span>
<span class='va'>df_clean3</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'>## # A tibble: 16 x 6</span>
<span class='co'>##    date       time                tm_home tm_away pts_home pts_away</span>
<span class='co'>##    &lt;date&gt;     &lt;dttm&gt;              &lt;chr&gt;   &lt;chr&gt;      &lt;int&gt;    &lt;int&gt;</span>
<span class='co'>##  1 2018-09-07 2018-09-07 00:55:00 PHI     ATL           18       12</span>
<span class='co'>##  2 2018-09-09 2018-09-09 17:00:00 BAL     BUF           47        3</span>
<span class='co'>##  3 2018-09-09 2018-09-09 17:00:00 IND     CIN           23       34</span>
<span class='co'>##  4 2018-09-09 2018-09-09 17:00:00 NE      HOU           27       20</span>
<span class='co'>##  5 2018-09-09 2018-09-09 17:00:00 NYG     JAX           15       20</span>
<span class='co'>##  6 2018-09-09 2018-09-09 17:00:00 CLE     PIT           21       21</span>
<span class='co'>##  7 2018-09-09 2018-09-09 17:00:00 MIN     SF            24       16</span>
<span class='co'>##  8 2018-09-09 2018-09-09 17:00:00 NO      TB            40       48</span>
<span class='co'>##  9 2018-09-09 2018-09-09 17:00:00 MIA     TEN           27       20</span>
<span class='co'>## 10 2018-09-09 2018-09-09 20:05:00 LAC     KC            28       38</span>
<span class='co'>## 11 2018-09-09 2018-09-09 20:25:00 CAR     DAL           16        8</span>
<span class='co'>## 12 2018-09-09 2018-09-09 20:25:00 DEN     SEA           27       24</span>
<span class='co'>## 13 2018-09-09 2018-09-09 20:25:00 ARI     WSH            6       24</span>
<span class='co'>## 14 2018-09-10 2018-09-10 00:20:00 GB      CHI           24       23</span>
<span class='co'>## 15 2018-09-10 2018-09-10 23:10:00 DET     NYJ           17       48</span>
<span class='co'>## 16 2018-09-11 2018-09-11 02:20:00 OAK     LAR           13       33</span>
</code></pre>
</div>
</div>
<p>And there we have it! A nice, tidy <code>tibble</code> with the scores of the first week of regular season games in the 2018 NFL regular season.</p>
<h2 id="sign-off">Sign-off</h2>
<p>Hopefully someone out there will find the technique(s) shown in this post to be useful for an endeavor of their own.</p>
<p>Personally, I find web scraping to be fascinating, so I doubt this will be the last time I write about something of this nature.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>I use <code>data.frame</code> and <code>tibble</code> interchangeably. See <a href="http://r4ds.had.co.nz/tibbles.html">this chapter</a> of the <a href="http://r4ds.had.co.nz/"><strong><em>R for Data Science</em></strong></a> for more details about the differences/similarities between the two.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>(See the webpage here: <a href="http://www.espn.com/nfl/scoreboard/_/year/2018/seasontype/2/week/1" class="uri">http://www.espn.com/nfl/scoreboard/_/year/2018/seasontype/2/week/1</a>. Note that we won’t be scraping the html, but, instead, the underlying JSON from which the html is generated.)<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3" role="doc-endnote"><p>I say that it’s a secret because it’s API documentation is out of date.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4" role="doc-endnote"><p>As a note to the reader, I don’t recommend suffixing variable names with numbers as I do in the next couple of step (i.e. variables suffixed with <code>1</code>, <code>2</code>, …) (It’s ugly!) In practice, you might do this during your exploratory phase of data scraping/analysis, but you should come up with more informative names and combine actions in a logical manner for your final script/package (in my opinion).<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
